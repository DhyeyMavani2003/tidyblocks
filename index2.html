



<!-- begin snippet: js hide: false console: true babel: null -->

<!-- language: lang-html -->

<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
    
        <!-- Visual appearance -->
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
        <link rel="stylesheet" href="style2.css">
    
      </head>
      <body>

    <div class="topnav">

        <button href="./guide/">
          <i class="fa fa-question-circle fa-lg"></i>
          </button>

          <input type="file" id="imgupload" style="display:none" onchange="loadCode(this.files)"/> 
          <button id="OpenImgUpload"><i class="fa fa-upload fa-lg"></i></button>


        <div class="dropdown">
            <button>
                <i class="fa fa-save fa-lg"></i>
              </button>
            <div class="dropdown-content">
            <a id="downloadPlot" href="#" onclick="saveCode()">Workspace</a>
            <a id="downloadData" href="#" onclick="exportCSVFile(itemsFormatted, fileTitle);">Data</a>
            <a id="savePlot" href="#">Plot</a>
            </div>
        </div>

        <div class="topnav-right">
          <a class="logo" style="pointer-events:none;">TidyBlocks</a>
        </div>
      </div>


    <div class="splitter">
    	<div id="first">
          <div id="blockDisplay">
              <xml id="toolbox">
                <category name="data" categorystyle="data">
                  <block type="data_colors"></block>
                  <block type="data_double"></block>
                  <block type="data_earthquakes"></block>
                  <block type="data_iris"></block>
                  <block type="data_missing"></block>
                  <block type="data_mtcars"></block>
                  <block type="data_toothGrowth"></block>
                  <block type="data_single"></block>
                  <block type="data_urlCSV"></block>
                </category>
                <category name="transform" categorystyle="transform">
                  <block type="transform_filter"></block>
                  <block type="transform_groupBy"></block>
                  <block type="transform_mutate"></block>
                  <block type="transform_select"></block>
                  <block type="transform_sort"></block>
                  <block type="transform_summarize">
                      <statement name="COLUMN_FUNC_PAIR">
                        <block type="transform_summarize_item"></block>
                      </statement>
                  </block>
                  <block type="transform_summarize_item"></block>
                  <block type="transform_ungroup"></block>
                </category>
                <category name="plot" categorystyle="plot">
                  <block type="plot_bar"></block>
                  <block type="plot_boxplot"></block>
                  <block type="plot_hist"></block>
                  <block type="plot_point"></block>
                  <block type="plot_table"></block>
                </category>
                <category name="plumbing" categorystyle="plumbing">
                  <block type="plumbing_join"></block>
                  <block type="plumbing_notify"></block>
                </category>
                <category name="values" categorystyle="values">
                  <block type="value_arithmetic"></block>
                  <block type="value_boolean"></block>
                  <block type="value_column"></block>
                  <block type="value_compare"></block>
                  <block type="value_convert"></block>
                  <block type="value_convert_datetime"></block>
                  <block type="value_datetime"></block>
                  <block type="value_ifElse"></block>
                  <block type="value_negate"></block>
                  <block type="value_not"></block>
                  <block type="value_number"></block>
                  <block type="value_logical"></block>
                  <block type="value_text"></block>
                  <block type="value_type"></block>
                </category>
              </xml>
               <div class="fab" id="runCode" onclick="runCode(); showCode();">RUN</div>
            </div>
      </div>
    	<div id="separator" ></div>
    	<div id="second" >
          <div class="tabs">
              <input name="tabs" type="radio" id="tab-1" checked="checked" class="input"/>
              <label for="tab-1" class="label">Data</label>
              <div class="panel" id="data">
                <div id="dataOutput"></div>
              </div>
            
              <input name="tabs" type="radio" id="tab-2" class="input"/>
              <label for="tab-2" class="label">Plot</label>
              <div class="panel">
                <div id="plotOutput"></div>
              </div>
            
              <input name="tabs" type="radio" id="tab-3" class="input"/>
              <label for="tab-3" class="label">Debug</label>
              <div class="panel">
                  <div id="error"></div>
                </div>

              <input name="tabs" type="radio" id="tab-4" class="input"/>
              <label for="tab-4" class="label">Text</label>
              <div class="panel" id="codeOutputDiv">
                <div id="codeOutput"></div>
              </div>
            </div>
      </div>
    </div>

    <!-- Blockly itself -->
    <script language="javascript" type="text/javascript" src="static/blockly_compressed.js"></script>
    <script language="javascript" type="text/javascript" src="static/blocks_compressed.js"></script>
    <script language="javascript" type="text/javascript" src="static/javascript_compressed.js"></script>
    <script language="javascript" type="text/javascript" src="static/msg/js/en.js"></script>

    <!-- DataForge, Vega-Lite, and what-not -->
    <script src="https://cdn.jsdelivr.net/npm/vega@5.4.0"></script>
    <script src="https://cdn.jsdelivr.net/npm/vega-lite@3.3.0"></script>
    <script src="https://cdn.jsdelivr.net/npm/vega-embed@4.2.0"></script>
    <script src="https://cdn.jsdelivr.net/npm/papaparse@5.0.2/papaparse.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/0.4.1/html2canvas.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.4.1.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>

    <!-- Put all blocks code in a div so it's easy to find and load for testing. -->
    <div id="tidyblocks">
      <!-- TidyBlocks supports -->
      <script src="tidyblocks/tidyblocks.js"></script>
      <script src="tidyblocks/gui.js"></script>
      <script src="tidyblocks/themes.js"></script>

      <!-- TidyBlocks blocks -->

      <script src="blocks/data_colors.js"></script>
      <script src="generators/js/data_colors.js"></script>

      <script src="blocks/data_double.js"></script>
      <script src="generators/js/data_double.js"></script>

      <script src="blocks/data_earthquakes.js"></script>
      <script src="generators/js/data_earthquakes.js"></script>

      <script src="blocks/data_iris.js"></script>
      <script src="generators/js/data_iris.js"></script>

      <script src="blocks/data_missing.js"></script>
      <script src="generators/js/data_missing.js"></script>

      <script src="blocks/data_mtcars.js"></script>
      <script src="generators/js/data_mtcars.js"></script>

      <script src="blocks/data_toothGrowth.js"></script>
      <script src="generators/js/data_toothGrowth.js"></script>

      <script src="blocks/data_single.js"></script>
      <script src="generators/js/data_single.js"></script>

      <script src="blocks/data_urlCSV.js"></script>
      <script src="generators/js/data_urlCSV.js"></script>

      <script src="blocks/transform_filter.js"></script>
      <script src="generators/js/transform_filter.js"></script>

      <script src="blocks/transform_groupby.js"></script>
      <script src="generators/js/transform_groupby.js"></script>

      <script src="blocks/transform_mutate.js"></script>
      <script src="generators/js/transform_mutate.js"></script>

      <script src="blocks/transform_select.js"></script>
      <script src="generators/js/transform_select.js"></script>

      <script src="blocks/transform_sort.js"></script>
      <script src="generators/js/transform_sort.js"></script>

      <script src="blocks/transform_summarize.js"></script>
      <script src="generators/js/transform_summarize.js"></script>

      <script src="blocks/transform_summarize_item.js"></script>
      <script src="generators/js/transform_summarize_item.js"></script>

      <script src="blocks/transform_ungroup.js"></script>
      <script src="generators/js/transform_ungroup.js"></script>

      <script src="blocks/plot_bar.js"></script>
      <script src="generators/js/plot_bar.js"></script>

      <script src="blocks/plot_boxplot.js"></script>
      <script src="generators/js/plot_boxplot.js"></script>

      <script src="blocks/plot_hist.js"></script>
      <script src="generators/js/plot_hist.js"></script>

      <script src="blocks/plot_point.js"></script>
      <script src="generators/js/plot_point.js"></script>

      <script src="blocks/plot_table.js"></script>
      <script src="generators/js/plot_table.js"></script>

      <script src="blocks/plumbing_join.js"></script>
      <script src="generators/js/plumbing_join.js"></script>

      <script src="blocks/plumbing_notify.js"></script>
      <script src="generators/js/plumbing_notify.js"></script>

      <script src="blocks/value_arithmetic.js"></script>
      <script src="generators/js/value_arithmetic.js"></script>

      <script src="blocks/value_boolean.js"></script>
      <script src="generators/js/value_boolean.js"></script>

      <script src="blocks/value_column.js"></script>
      <script src="generators/js/value_column.js"></script>

      <script src="blocks/value_compare.js"></script>
      <script src="generators/js/value_compare.js"></script>

      <script src="blocks/value_convert.js"></script>
      <script src="generators/js/value_convert.js"></script>

      <script src="blocks/value_convert_datetime.js"></script>
      <script src="generators/js/value_convert_datetime.js"></script>

      <script src="blocks/value_datetime.js"></script>
      <script src="generators/js/value_datetime.js"></script>

      <script src="blocks/value_ifelse.js"></script>
      <script src="generators/js/value_ifelse.js"></script>

      <script src="blocks/value_negate.js"></script>
      <script src="generators/js/value_negate.js"></script>

      <script src="blocks/value_not.js"></script>
      <script src="generators/js/value_not.js"></script>

      <script src="blocks/value_number.js"></script>
      <script src="generators/js/value_number.js"></script>

      <script src="blocks/value_logical.js"></script>
      <script src="generators/js/value_logical.js"></script>

      <script src="blocks/value_text.js"></script>
      <script src="generators/js/value_text.js"></script>

      <script src="blocks/value_type.js"></script>
      <script src="generators/js/value_type.js"></script>
    </div>

    <!-- R code
    <script language="javascript" type="text/javascript" src="languages/r.js"></script>
    <script src="generators/r/data_colors.js"></script>
    <script src="generators/r/data_earthquakes.js"></script>
    <script src="generators/r/data_iris.js"></script>
    <script src="generators/r/data_mtcars.js"></script>
    <script src="generators/r/data_toothGrowth.js"></script>
    <script src="generators/r/data_single.js"></script>
    <script src="generators/r/data_urlCSV.js"></script>
    <script src="generators/r/transform_filter.js"></script>
    <script src="generators/r/transform_groupby.js"></script>
    <script src="generators/r/transform_mutate.js"></script>
    <script src="generators/r/transform_select.js"></script>
    <script src="generators/r/transform_summarize.js"></script>
    <script src="generators/r/value_compare.js"></script>
    -->


    <script>

    $('#OpenImgUpload').click(function(){ $('#imgupload').trigger('click'); });

    document.addEventListener('DOMContentLoaded', (event) => {
        setUpBlockly()
    })

    // function is used for dragging and moving
    function dragElement( element, direction)
    {
        var   md; // remember mouse down info
        const first  = document.getElementById("first");
        const second = document.getElementById("second");
        
        element.onmousedown = onMouseDown;
        
        function onMouseDown( e )
        {
    	//console.log("mouse down: " + e.clientX);
    	md = {e,
    	      offsetLeft:  element.offsetLeft,
    	      offsetTop:   element.offsetTop,
    	      firstWidth:  first.offsetWidth,
    	      secondWidth: second.offsetWidth};
    	document.onmousemove = onMouseMove;
    	document.onmouseup = () => { 
    	    //console.log("mouse up");
    	    document.onmousemove = document.onmouseup = null;
    	}
        }
        
        function onMouseMove( e )
        {
    	//console.log("mouse move: " + e.clientX);
    	var delta = {x: e.clientX - md.e.x,
    		     y: e.clientY - md.e.y};
    	
    	if (direction === "H" ) // Horizontal
    	{
    	    // prevent negative-sized elements
    	    delta.x = Math.min(Math.max(delta.x, -md.firstWidth),
    			       md.secondWidth);
    	    
    	    element.style.left = md.offsetLeft + delta.x + "px";
    	    first.style.width = (md.firstWidth + delta.x) + "px";
    	    second.style.width = (md.secondWidth - delta.x) + "px";
    	}
        }
    }

    dragElement( document.getElementById("separator"), "H" );

    var x, i, j, selElmnt, a, b, c;
/*look for any elements with the class "custom-select":*/
x = document.getElementsByClassName("custom-select");
for (i = 0; i < x.length; i++) {
  selElmnt = x[i].getElementsByTagName("select")[0];
  /*for each element, create a new DIV that will act as the selected item:*/
  a = document.createElement("DIV");
  a.setAttribute("class", "select-selected");
  a.innerHTML = selElmnt.options[selElmnt.selectedIndex].innerHTML;
  x[i].appendChild(a);
  /*for each element, create a new DIV that will contain the option list:*/
  b = document.createElement("DIV");
  b.setAttribute("class", "select-items select-hide");
  for (j = 1; j < selElmnt.length; j++) {
    /*for each option in the original select element,
    create a new DIV that will act as an option item:*/
    c = document.createElement("DIV");
    c.innerHTML = selElmnt.options[j].innerHTML;
    c.addEventListener("click", function(e) {
        /*when an item is clicked, update the original select box,
        and the selected item:*/
        var y, i, k, s, h;
        s = this.parentNode.parentNode.getElementsByTagName("select")[0];
        h = this.parentNode.previousSibling;
        for (i = 0; i < s.length; i++) {
          if (s.options[i].innerHTML == this.innerHTML) {
            s.selectedIndex = i;
            h.innerHTML = this.innerHTML;
            y = this.parentNode.getElementsByClassName("same-as-selected");
            for (k = 0; k < y.length; k++) {
              y[k].removeAttribute("class");
            }
            this.setAttribute("class", "same-as-selected");
            break;
          }
        }
        h.click();
    });
    b.appendChild(c);
  }
  x[i].appendChild(b);
  a.addEventListener("click", function(e) {
      /*when the select box is clicked, close any other select boxes,
      and open/close the current select box:*/
      e.stopPropagation();
      closeAllSelect(this);
      this.nextSibling.classList.toggle("select-hide");
      this.classList.toggle("select-arrow-active");
    });
}
function closeAllSelect(elmnt) {
  /*a function that will close all select boxes in the document,
  except the current select box:*/
  var x, y, i, arrNo = [];
  x = document.getElementsByClassName("select-items");
  y = document.getElementsByClassName("select-selected");
  for (i = 0; i < y.length; i++) {
    if (elmnt == y[i]) {
      arrNo.push(i)
    } else {
      y[i].classList.remove("select-arrow-active");
    }
  }
  for (i = 0; i < x.length; i++) {
    if (arrNo.indexOf(i)) {
      x[i].classList.add("select-hide");
    }
  }
}
/*if the user clicks anywhere outside the select box,
then close all select boxes:*/
document.addEventListener("click", closeAllSelect);

    </script>
    </body>
    </html>

